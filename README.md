# PdfCutter

一个基于 Windows Forms 的轻量级 PDF 页面裁剪与打印工具。支持打开 PDF、框选裁剪区域、自动检测非白色内容区域、预览/保存裁剪图片，以及打印与打印预览。支持记忆上次使用的打印机与纸张大小。

## 功能特性
- 打开 PDF 并渲染当前页为高分辨率位图（基于 `PdfiumViewer`）
- 鼠标拖拽框选任意矩形区域
- 自动检测页面中的非白色内容区域（一键生成选区）
- 裁剪并在界面中预览选区图片
- 将裁剪结果保存为 PNG/JPEG/BMP
- 直接打印当前页或裁剪结果，并显示实际打印缩放比例
- 打印预览窗口内支持页面设置、打印机设置与一键打印
- 工具栏内快速选择打印机与纸张，并自动记忆上次选择
- 支持启动时通过命令行参数直接打开指定文件

## 运行环境
- Windows 10/11
- .NET 9 SDK（或使用已发布的可执行文件）

## 构建与运行
```bash
dotnet build
dotnet run -- <PDF文件路径（可选）>
```

也可在 Visual Studio 中打开解决方案 `PdfCutter.sln`，选择 Debug/Release 后直接运行。

发布示例：
```bash
dotnet publish -c Release -r win-x64 --self-contained false
```

## 使用说明
1. 打开程序后，点击工具栏的“打开PDF”选择文件；或通过命令行参数直接打开：
   ```bash
   PdfCutter.exe "C:\path\to\file.pdf"
   ```
2. 在画面上按住左键拖拽，框选要保留的区域。
3. 若不想手动框选，可点击“自动检测”，程序会根据页面内容自动生成一个贴合内容的选区。
4. 点击“裁剪”生成预览，预览会显示在主区域。
5. 点击“保存”将裁剪结果导出为 PNG（默认）、JPEG 或 BMP。
6. 点击“打印”可直接打印当前页或裁剪结果（优先打印裁剪结果）。
7. 点击“打印预览”可在预览窗口中进行页面设置、打印机设置后再打印。

## 打印与纸张设置
- 工具栏左侧提供“打印机”和“纸张”下拉框：
  - 选择打印机后，会自动加载该打印机支持的纸张列表。
  - 选择的打印机与纸张会被保存，下次启动自动恢复。
- 打印时程序会根据图片与纸张的纵横比自动选择横/竖向，并在页边距内等比缩放。
- 打印完成后会弹出本次打印的缩放比例，便于对齐调整。

## 快捷提示
- 未裁剪时，“打印/打印预览”将作用于整页渲染图；裁剪后优先作用于裁剪结果。
- 保存时根据扩展名自动判断格式（.png/.jpg/.jpeg/.bmp）。

## 依赖
- `PdfiumViewer`（PDF 渲染）
- `itext7`（项目中已引入，当前功能未直接使用合并/拆分，但保留作为扩展能力）

相关原生库已作为构建输出的一部分放在 `bin/Debug/net9.0-windows/x64/pdfium.dll` 等位置，无需手动配置。

## 已知限制
- 当前版本按页处理 PDF，仅对“当前页”的位图进行框选、裁剪与打印。
- 自动检测基于阈值的“非白色像素”扫描，极端浅色背景可能需要手动框选微调。

## 许可
This project is licensed under the MIT License。